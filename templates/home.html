<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PlayOn â€“ Home</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/home.css') }}">
  <!-- NEW: Animations CSS for game effects -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/animations.css') }}">
</head>
<body>

  <!-- NEW: AUDIO SYSTEM (GLOBAL) -->
  
  <!-- Background Music -->
  <audio id="bgMusic" preload="auto" loop>
    <source src="{{ url_for('static', filename='audio/game-bg.wav') }}" type="audio/wav">
  </audio>

  <!-- Sound Effects -->
  <audio data-sound="win" preload="auto">
    <source src="{{ url_for('static', filename='audio/win.wav') }}" type="audio/wav">
  </audio>

  <audio data-sound="lose" preload="auto">
    <source src="{{ url_for('static', filename='audio/lose.wav') }}" type="audio/wav">
  </audio>

  <audio data-sound="bet" preload="auto">
    <source src="{{ url_for('static', filename='audio/bet.wav') }}" type="audio/wav">
  </audio>

  <audio data-sound="click" preload="auto">
    <source src="{{ url_for('static', filename='audio/click.wav') }}" type="audio/wav">
  </audio>

  <audio data-sound="gameover" preload="auto">
    <source src="{{ url_for('static', filename='audio/gameover.wav') }}" type="audio/wav">
  </audio>

  <!-- NEW: MUTE BUTTON (TOP-RIGHT) -->
  <button
    id="muteBtn"
    onclick="if (window.audioManager) window.audioManager.toggleMute()"
    title="Toggle sound"
    style="
      position: fixed;
      top: 10px;
      right: 10px;
      z-index: 1000;
      background: rgba(15,23,42,0.9);
      border: none;
      border-radius: 999px;
      width: 40px;
      height: 40px;
      cursor: pointer;
      font-size: 18px;
      color: #e5e7eb;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
    "
  >
    ðŸ”Š
  </button>

  <div class="app-container">

    <!-- TOP HEADER -->
    <header class="top-header">
      <div class="brand-section">
        <!-- Replace TRADEERA with logo image -->
        <img src="{{ url_for('static', filename='img/playon-logo.png') }}" alt="PlayOn" class="brand-logo" style="height:36px;"/>
        <!-- Underline subtitle with logged-in user -->
        <p class="brand-subtitle" style="font-size:15px;font-weight:700;color:#60a5fa;">
          PlayOn &nbsp;|&nbsp;
          <span id="homeUsername">{{ username }}</span>
        </p>
      </div>
      <div class="user-section">
        <div class="balance-pill" id="coinsPill">
          <div class="coin-icon">
            <img src="{{ url_for('static', filename='img/coin.png') }}" alt="Coins">
          </div>
          <span id="walletBalance">0</span>
        </div>
        <div class="profile-circle" onclick="window.location.href='/profile'">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>
        </div>
      </div>
    </header>

    <!-- MAIN CONTENT -->
    <main class="main-content">

      <!-- BONUS ROULETTE CARD -->
      <section class="featured-card">
        <div class="bonus-content">
          <h2 class="bonus-title">Bonus Roulette</h2>
          <p class="bonus-subtitle">Play every 60 minutes</p>
          <button class="play-now-btn" onclick="window.location.href='/game/roulette'">
            Play Now
          </button>
        </div>
        <div class="bonus-icon">
          <img
            src="{{ url_for('static', filename='img/roulette_wheel.png') }}"
            alt="Roulette"
            class="roulette-image"
          >
        </div>
      </section>

      <section class="games-section">
        <h3 class="section-title">Games</h3>
        <div class="games-grid">
          <div class="game-card silver-card" onclick="window.location.href='/game/silver'">
            <div class="game-icon">
              <img src="{{ url_for('static', filename='img/frog_icon.png') }}" alt="Silver" />
            </div>
            <div class="game-name game-name-silver">Silver</div>
            <div class="game-bet">Bet 10 Get 50</div>
          </div>
          <div class="game-card gold-card" onclick="window.location.href='/game/gold'">
            <div class="game-icon">
              <img src="{{ url_for('static', filename='img/football_goal.png') }}" alt="Gold" />
            </div>
            <div class="game-name game-name-gold">GOLD</div>
            <div class="game-bet">Bet 50 Get 250</div>
          </div>
          <div class="game-card diamond-card" onclick="window.location.href='/game/diamond'">
            <div class="game-icon">
              <img src="{{ url_for('static', filename='img/diamond_ball.png') }}" alt="Diamond" />
            </div>
            <div class="game-name game-name-diamond">DIAMOND</div>
            <div class="game-bet">Bet 100 Get 500</div>
          </div>
          <div class="game-card platinum-card" onclick="window.location.href='/game/platinum'">
            <div class="game-icon">
              <img src="{{ url_for('static', filename='img/platinum_rider.png') }}" alt="Platinum" />
            </div>
            <div class="game-name game-name-platinum">PLATINUM</div>
            <div class="game-bet">Bet 200 Get 1000</div>
          </div>
        </div>
      </section>
    </main>

    <nav class="bottom-nav">
      <div class="nav-item active" onclick="window.location.href='/home'">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M3 10.5 12 4l9 6.5V20a1.5 1.5 0 0 1-1.5 1.5H4.5A1.5 1.5 0 0 1 3 20Z"/>
          <path d="M9 21v-6h6v6" />
        </svg>
        <span>Home</span>
      </div>
      <div class="nav-item" onclick="window.location.href='/history'">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <circle cx="12" cy="12" r="9" />
          <polyline points="12 7 12 12 16 14" />
        </svg>
        <span>History</span>
      </div>
      <div class="nav-item" onclick="window.location.href='/profile'">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
          <circle cx="12" cy="7" r="4"></circle>
        </svg>
        <span>Profile</span>
      </div>
      <div class="nav-item" onclick="window.location.href='/help'">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <circle cx="12" cy="12" r="9" />
          <path d="M9.5 9a2.5 2.5 0 1 1 4.5 1.5c-.6.8-1.3 1.1-1.5 1.5v1" />
          <line x1="12" y1="17" x2="12.01" y2="17"></line>
        </svg>
        <span>Help</span>
      </div>
    </nav>

  </div>

  <!-- NEW: Audio Manager Scripts -->
  <script src="{{ url_for('static', filename='js/home.js') }}"></script>
  <script src="{{ url_for('static', filename='js/audio-manager.js') }}"></script>

  <script>
    // NEW: Initialize audio manager and wire background music + mute button
    if (typeof AudioManager !== 'undefined') {
      window.audioManager = new AudioManager();

      // First user click starts music (needed on mobile/iOS)
      document.addEventListener('click', () => {
        if (window.audioManager && !window.audioManager.isMuted) {
          window.audioManager.playBg();
        }
      }, { once: true });

      // Update mute button icon when toggled
      window.addEventListener('muteToggled', (e) => {
        const muteBtn = document.getElementById('muteBtn');
        if (muteBtn) {
          muteBtn.textContent = e.detail.isMuted ? 'ðŸ”‡' : 'ðŸ”Š';
        }
      });
    }
  </script>
<script>
  // Test audio file loading
  const bgMusic = document.getElementById('bgMusic');
  
  console.log('=== AUDIO FILE TEST ===');
  console.log('BG Music element:', bgMusic);
  console.log('BG Music duration:', bgMusic.duration);
  console.log('BG Music readyState:', bgMusic.readyState);
  
  bgMusic.addEventListener('loadedmetadata', () => {
    console.log('âœ… Audio loaded! Duration:', bgMusic.duration);
  });
  
  bgMusic.addEventListener('error', (e) => {
    console.error('âŒ Audio failed to load:', e);
  });
  
  bgMusic.addEventListener('canplay', () => {
    console.log('âœ… Audio can play!');
  });
</script>

</body>
</html>
