<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Game of Five</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='admin_styles.css') }}">
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>‚öôÔ∏è Admin Panel</h2>
            </div>
            
            <nav class="sidebar-menu">
                <ul>
                    <li class="menu-item active" data-section="dashboard">
                        <a href="#dashboard" class="menu-link">
                            <span class="icon">üìä</span>
                            <span class="label">Dashboard</span>
                        </a>
                    </li>
                    
                    <li class="menu-item" data-section="users">
                        <a href="#users" class="menu-link">
                            <span class="icon">üë•</span>
                            <span class="label">Users</span>
                        </a>
                    </li>
                    
                    <li class="menu-item" data-section="agents">
                        <a href="#agents" class="menu-link">
                            <span class="icon">ü§ù</span>
                            <span class="label">Agents</span>
                        </a>
                    </li>
                    
                    <li class="menu-item">
                        <a href="#" class="menu-link menu-toggle" data-target="games-submenu">
                            <span class="icon">üéÆ</span>
                            <span class="label">Games</span>
                            <span class="arrow">‚ñº</span>
                        </a>
                        <ul class="submenu" id="games-submenu">
                            <li><a href="#games" data-game="silver">üê∏ Silver</a></li>
                            <li><a href="#games" data-game="gold">‚öΩ Gold</a></li>
                            <li><a href="#games" data-game="diamond">üèπ Diamond</a></li>
                            <li><a href="#games" data-game="platinum">ü™Ç Platinum</a></li>
                        </ul>
                    </li>
                    
                    <li class="menu-item" data-section="revenue">
                        <a href="#revenue" class="menu-link">
                            <span class="icon">üí∞</span>
                            <span class="label">Revenue</span>
                        </a>
                    </li>
                    
                    <li class="menu-item" data-section="tickets">
                        <a href="#tickets" class="menu-link">
                            <span class="icon">üé´</span>
                            <span class="label">Tickets</span>
                        </a>
                    </li>
                    
                    <li class="menu-item" data-section="settings">
                        <a href="#settings" class="menu-link">
                            <span class="icon">‚öôÔ∏è</span>
                            <span class="label">Settings</span>
                        </a>
                    </li>
                </ul>
            </nav>
            
            <div class="sidebar-footer">
                <a href="/logout" class="logout-btn">
                    <span class="icon">üö™</span>
                    <span>Logout</span>
                </a>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="header">
                <div class="header-left">
                    <h1>Dashboard</h1>
                    <p id="header-subtitle">Welcome to Game of Five Admin Panel</p>
                </div>
                <div class="header-right">
                    <div class="admin-info">
                        <span class="admin-username" id="admin-username">Admin</span>
                        <span class="admin-role">Administrator</span>
                    </div>
                </div>
            </header>

            <!-- Dashboard Section -->
            <section id="dashboard" class="section active">
                <div class="section-header">
                    <h2>Dashboard Overview</h2>
                    <p>Real-time statistics and analytics</p>
                </div>

                <!-- First Row: Users Stats -->
                <div class="stats-row">
                    <div class="stat-card">
                        <div class="stat-icon users-icon">üë•</div>
                        <div class="stat-content">
                            <h3>Total Users</h3>
                            <p class="stat-value" id="total-users">-</p>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon active-icon">‚úÖ</div>
                        <div class="stat-content">
                            <h3>Active Users</h3>
                            <p class="stat-value" id="active-users">-</p>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon inactive-icon">‚ùå</div>
                        <div class="stat-content">
                            <h3>Inactive Users</h3>
                            <p class="stat-value" id="inactive-users">-</p>
                        </div>
                    </div>
                </div>

                <!-- Second Row: Revenue Stats -->
                <div class="stats-row">
                    <div class="stat-card">
                        <div class="stat-icon revenue-icon">üíπ</div>
                        <div class="stat-content">
                            <h3>Total Revenue</h3>
                            <p class="stat-value" id="total-revenue">‚Çπ-</p>
                            <p class="stat-label">(Deposit - Withdrawal)</p>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon deposit-icon">üìà</div>
                        <div class="stat-content">
                            <h3>Total Deposit</h3>
                            <p class="stat-value" id="total-deposit">‚Çπ-</p>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon withdrawal-icon">üìâ</div>
                        <div class="stat-content">
                            <h3>Total Withdrawal</h3>
                            <p class="stat-value" id="total-withdrawal">‚Çπ-</p>
                        </div>
                    </div>
                </div>

                <!-- Third Row: Activity Stats -->
                <div class="stats-row">
                    <div class="stat-card">
                        <div class="stat-icon games-icon">üéÆ</div>
                        <div class="stat-content">
                            <h3>Games Played Today</h3>
                            <p class="stat-value" id="active-games">-</p>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon tickets-icon">üé´</div>
                        <div class="stat-content">
                            <h3>Active Tickets</h3>
                            <p class="stat-value" id="open-tickets">-</p>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon blocked-icon">üö´</div>
                        <div class="stat-content">
                            <h3>Blocked Users</h3>
                            <p class="stat-value" id="blocked-users">-</p>
                        </div>
                    </div>
                </div>

                <!-- Last Updated -->
                <div class="last-updated">
                    Last updated: <span id="last-update">Just now</span>
                    <button class="refresh-btn" id="refresh-stats">üîÑ Refresh</button>
                </div>
            </section>

            <!-- Users Section -->
            <section id="users" class="section">
                <div class="section-header">
                    <h2>User Management</h2>
                    <p>Manage and monitor all users</p>
                </div>
                <div id="users-content" class="content-placeholder">
                    Users management will be implemented next
                </div>
            </section>

            <!-- Agents Section -->
            <section id="agents" class="section">
                <div class="section-header">
                    <h2>Agents Management</h2>
                    <p>Manage affiliate agents</p>
                </div>
                <div id="agents-content" class="content-placeholder">
                    Agents management will be implemented next
                </div>
            </section>

            <!-- Games Section -->
            <section id="games" class="section">
                <div class="section-header">
                    <h2>Game Management</h2>
                    <p>Monitor active games and statistics</p>
                </div>
                <div id="games-content" class="content-placeholder">
                    Games management will be implemented next
                </div>
            </section>

            <!-- Revenue Section -->
            <section id="revenue" class="section">
                <div class="section-header">
                    <h2>Revenue Analytics</h2>
                    <p>Detailed revenue and financial reports</p>
                </div>
                <div id="revenue-content" class="content-placeholder">
                    Revenue analytics will be implemented next
                </div>
            </section>

            <!-- Tickets Section -->
            <section id="tickets" class="section">
                <div class="section-header">
                    <h2>Support Tickets</h2>
                    <p>Manage customer support tickets</p>
                </div>
                <div id="tickets-content" class="content-placeholder">
                    Tickets management will be implemented next
                </div>
            </section>

            <!-- Settings Section -->
            <section id="settings" class="section">
                <div class="section-header">
                    <h2>Settings</h2>
                    <p>System and admin settings</p>
                </div>
                <div id="settings-content" class="content-placeholder">
                    Settings will be implemented next
                </div>
            </section>
        </main>
    </div>

    <script>
        // Session storage
        const adminUsername = sessionStorage.getItem('username') || 'Admin';
        document.getElementById('admin-username').textContent = adminUsername;

        // Sidebar navigation
        document.querySelectorAll('.menu-item').forEach(item => {
            item.addEventListener('click', function(e) {
                if (this.classList.contains('menu-item') && !e.target.closest('.menu-toggle')) {
                    const section = this.getAttribute('data-section');
                    if (section) {
                        showSection(section);
                        document.querySelectorAll('.menu-item').forEach(m => m.classList.remove('active'));
                        this.classList.add('active');
                    }
                }
            });
        });

        // Submenu toggle
        document.querySelectorAll('.menu-toggle').forEach(toggle => {
            toggle.addEventListener('click', function(e) {
                e.preventDefault();
                const target = this.getAttribute('data-target');
                const submenu = document.getElementById(target);
                submenu.classList.toggle('open');
                this.classList.toggle('open');
            });
        });

        // Section display
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            const section = document.getElementById(sectionId);
            if (section) {
                section.classList.add('active');
                document.getElementById('header-subtitle').textContent = 
                    section.querySelector('h2').textContent;
            }
        }

        // Load dashboard stats
        async function loadStats() {
            try {
                const response = await fetch('/api/admin/stats');
                const stats = await response.json();
                
                document.getElementById('total-users').textContent = stats.total_users;
                document.getElementById('active-users').textContent = stats.active_users;
                document.getElementById('inactive-users').textContent = stats.inactive_users;
                document.getElementById('total-revenue').textContent = `‚Çπ${stats.total_revenue.toLocaleString()}`;
                document.getElementById('total-deposit').textContent = `‚Çπ${stats.total_deposit.toLocaleString()}`;
                document.getElementById('total-withdrawal').textContent = `‚Çπ${stats.total_withdrawal.toLocaleString()}`;
                document.getElementById('active-games').textContent = stats.active_games;
                document.getElementById('open-tickets').textContent = stats.open_tickets;
                document.getElementById('blocked-users').textContent = stats.blocked_users;
                
                const now = new Date();
                document.getElementById('last-update').textContent = now.toLocaleTimeString();
            } catch (error) {
                console.error('Error loading stats:', error);
            }
        }

        // Refresh button
        document.getElementById('refresh-stats').addEventListener('click', loadStats);

        // Initial load
        loadStats();

        // Auto-refresh every 30 seconds
        setInterval(loadStats, 30000);
    </script>
</body>
</html>
